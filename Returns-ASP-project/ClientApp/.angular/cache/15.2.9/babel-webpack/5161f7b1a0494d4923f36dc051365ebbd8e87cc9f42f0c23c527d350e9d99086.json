{"ast":null,"code":"var _class;\nimport { formatDate } from '@angular/common';\nimport { LOCALE_ID } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { debounceTime, distinctUntilChanged, filter, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../api/services\";\nimport * as i3 from \"../auth/auth.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../app.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@ng-bootstrap/ng-bootstrap\";\nconst _c0 = [\"resolvedDropdown\"];\nfunction ReturnDetailComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.custIdFromTemplate);\n  }\n}\nfunction ReturnDetailComponent_div_11_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Customer is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_11_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.getCustomer.errors == null ? null : ctx_r1.getCustomer.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.prodIdFromTemplate);\n  }\n}\nfunction ReturnDetailComponent_div_22_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Product is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_22_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.getProduct.errors == null ? null : ctx_r4.getProduct.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_div_52_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r8.ownerIdFromTemplate);\n  }\n}\nfunction ReturnDetailComponent_div_53_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Owner is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_53_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.getOwner.errors == null ? null : ctx_r9.getOwner.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_div_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r11.faultIdFromTemplate);\n  }\n}\nfunction ReturnDetailComponent_div_64_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Fault is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_64_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r12.getFault.errors == null ? null : ctx_r12.getFault.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_div_74_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Document Number is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_74_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_74_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r14.getDocNo.errors == null ? null : ctx_r14.getDocNo.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_div_79_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Document Date is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_79_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ReturnDetailComponent_div_79_div_1_Template, 2, 0, \"div\", 41);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r15.getDocDate.errors == null ? null : ctx_r15.getDocDate.errors[\"required\"]);\n  }\n}\nfunction ReturnDetailComponent_option_86_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 42);\n    i0.ɵɵtext(1, \"Resolved\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_option_87_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 43);\n    i0.ɵɵtext(1, \"Investigate\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_option_88_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 43);\n    i0.ɵɵtext(1, \"Investigate\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_option_89_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 42);\n    i0.ɵɵtext(1, \"Resolved\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReturnDetailComponent_div_94_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 44);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r20 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r20.formInvalid, \" \");\n  }\n}\nconst _c1 = function () {\n  return [\"/customer-detail\"];\n};\nconst _c2 = function () {\n  return [\"/product-detail\"];\n};\nconst _c3 = function () {\n  return [\"/owner-detail\"];\n};\nconst _c4 = function () {\n  return [\"/fault-detail\"];\n};\nconst _c5 = function () {\n  return [\"/\"];\n};\nexport class ReturnDetailComponent {\n  //form: FormGroup;\n  constructor(route, returnService, router, authService, fb, locale, appService, userService, customerService, productService, faultService, ownerService) {\n    this.route = route;\n    this.returnService = returnService;\n    this.router = router;\n    this.authService = authService;\n    this.fb = fb;\n    this.locale = locale;\n    this.appService = appService;\n    this.userService = userService;\n    this.customerService = customerService;\n    this.productService = productService;\n    this.faultService = faultService;\n    this.ownerService = ownerService;\n    this.notFound = 'Not Found';\n    this.notLoaded = 'Not Loaded';\n    this.formInvalid = '';\n    this.returnId = this.notLoaded;\n    this.batchDateDisable = false;\n    this.modelInUse = 'none';\n    this.return = {};\n    this.customer = {};\n    this.product = {};\n    this.fault = {};\n    this.owner = {};\n    this.custIdFromTemplate = '';\n    this.prodIdFromTemplate = '';\n    this.faultIdFromTemplate = '';\n    this.ownerIdFromTemplate = '';\n    this.customerList = [];\n    this.productList = [];\n    this.faultList = [];\n    this.ownerList = [];\n    this.message = 'Something went wrong...';\n    this.showToast = false;\n    this.userId = this.notLoaded;\n    this.form = this.fb.group({\n      customer: ['', Validators.required],\n      product: ['', Validators.required],\n      qtyOnDoc: [0],\n      qtyReturned: [0],\n      batchDate: [''],\n      owner: [''],\n      fault: [''],\n      docNo: ['', Validators.required],\n      docDate: [new Date(), Validators.required],\n      resolved: [true],\n      comment: ['']\n    });\n    this.custFormatter = customer => customer.customerName;\n    this.prodFormatter = product => product.productName;\n    this.faultFormatter = fault => fault.name;\n    this.ownerFormatter = owner => owner.firstName;\n    //Gets all customers for searchbox\n    this.searchCust = text$ => {\n      this.customerService.searchCustomer().subscribe(c => this.customerList = c, this.handleError);\n      return text$.pipe(debounceTime(200), distinctUntilChanged(), filter(term => term.length >= 2), map(term => this.customerList.filter(customer => new RegExp(term, 'mi').test(customer.customerName)).slice(0, 10)));\n    };\n    //Gets all products for searchbox\n    this.searchProd = text$ => {\n      this.productService.searchProduct().subscribe(p => this.productList = p, this.handleError);\n      return text$.pipe(debounceTime(200), distinctUntilChanged(), filter(term => term.length >= 2), map(term => this.productList.filter(product => new RegExp(term, 'mi').test(product.productName)).slice(0, 10)));\n    };\n    //Gets all faults for searchbox\n    this.searchFault = text$ => {\n      this.faultService.searchFault().subscribe(f => this.faultList = f, this.handleError);\n      return text$.pipe(debounceTime(200), distinctUntilChanged(), filter(term => term.length >= 2), map(term => this.faultList.filter(fault => new RegExp(term, 'mi').test(fault.name)).slice(0, 10)));\n    };\n    //Gets all owners for searchbox\n    this.searchOwner = text$ => {\n      this.ownerService.searchOwner().subscribe(o => this.ownerList = o, this.handleError);\n      return text$.pipe(debounceTime(200), distinctUntilChanged(), filter(term => term.length >= 2), map(term => this.ownerList.filter(owner => new RegExp(term, 'mi').test(owner.firstName)).slice(0, 10)));\n    };\n    this.getUserId = userId => {\n      this.userId = userId;\n    };\n    this.findReturn = returnId => {\n      this.returnId = returnId ?? 'not passed';\n      this.returnService.findReturn({\n        id: this.returnId\n      }).subscribe(r => {\n        this.return = r;\n        this.customerService.findCustomer({\n          id: r.customerId\n        }).subscribe(c => {\n          this.setCustomerName(c);\n          this.custIdFromTemplate = c.id;\n        }, this.handleError);\n        this.productService.findProduct({\n          id: r.productId\n        }).subscribe(p => {\n          this.setProductName(p);\n          this.prodIdFromTemplate = p.id;\n        }, this.handleError);\n        this.faultService.findFault({\n          id: r.faultId\n        }).subscribe(f => {\n          this.setFaultName(f);\n          this.faultIdFromTemplate = f.id;\n        }, this.handleError);\n        this.ownerService.findOwner({\n          id: r.ownerId\n        }).subscribe(o => {\n          this.setOwnerName(o);\n          this.ownerIdFromTemplate = o.id;\n        }, this.handleError);\n        //this.userService.findUser({ }) set up endpoint to find user by Id as well\n        this.form.controls.qtyOnDoc.setValue(r.qtyOnDoc);\n        this.form.controls.qtyReturned.setValue(r.qtyReturned);\n        this.form.controls.batchDate.setValue(r.batchDate);\n        this.form.controls.docNo.setValue(r.docNo);\n        this.form.controls.docDate.setValue(new Date(r.docDate));\n        this.form.controls.resolved.setValue(r.resolved);\n        this.form.controls.comment.setValue(r.comment);\n      }, this.handleError);\n    };\n    this.handleError = err => {\n      if (err.status == 404) {\n        this.router.navigate(['/search-returns']);\n      }\n      console.log(\"Response Error. Status: \", err.status);\n      console.log(\"Response Error. Status: \", err.statusText);\n      console.log(err);\n    };\n  }\n  ngAfterViewInit() {}\n  ngOnInit() {\n    if (!this.authService.currentUser) {\n      this.router.navigate(['/register-user']);\n    }\n    this.userService.findUser({\n      email: this.authService.currentUser?.email\n    }).subscribe(u => {\n      this.getUserId(u.id);\n      console.log('The user id in the oninit subscribe call is: ' + this.userId);\n    });\n    this.route.paramMap.subscribe(p => this.findReturn(p.get(\"returnId\")));\n    console.log('OnInit userEmail = ' + this.authService.currentUser?.email);\n  }\n  toggleBatch() {\n    this.batchDateDisable = !this.batchDateDisable;\n    if (this.batchDateDisable == true && this.return.batchDate?.length > 1) {\n      this.form.controls['batchDate'].disable();\n      this.form.controls.batchDate.setValue(null);\n    } else if (this.batchDateDisable == false && this.return.batchDate?.length > 1) {\n      this.form.controls['batchDate'].enable();\n    } else if (this.batchDateDisable == true) {\n      this.form.controls['batchDate'].enable();\n      this.form.controls.batchDate.setValue(null);\n    } else if (this.batchDateDisable == false) {\n      this.form.controls['batchDate'].disable();\n    }\n  }\n  //Gets the id and name of the model in the search criteria\n  getModel(modelName, type) {\n    let modelFound = [];\n    //Get the type of model\n    if (type == 'customerType') {\n      let customerFound = this.customerList.filter(c => c.customerName == modelName);\n      console.log(customerFound.length);\n      if (customerFound.length > 0) {\n        customerFound.map(c => {\n          this.custIdFromTemplate = c.id;\n          this.customer.customerName = c.customerName;\n        });\n      } else {\n        this.custIdFromTemplate = this.notFound;\n      }\n    }\n    if (type == 'productType') {\n      let productFound = this.productList.filter(p => p.productName == modelName);\n      if (productFound.length > 0) {\n        productFound.map(p => {\n          this.prodIdFromTemplate = p.id;\n          this.product.productName = p.productName;\n        });\n      } else {\n        this.prodIdFromTemplate = this.notFound;\n      }\n    }\n    if (type == 'faultType') {\n      let faultFound = this.faultList.filter(f => f.name == modelName);\n      if (faultFound.length > 0) {\n        faultFound.map(f => {\n          this.faultIdFromTemplate = f.id;\n          this.fault.name = f.name;\n        });\n      } else {\n        this.faultIdFromTemplate = this.notFound;\n      }\n    }\n    if (type == 'ownerType') {\n      let ownerFound = this.ownerList.filter(o => o.firstName == modelName);\n      if (ownerFound.length > 0) {\n        ownerFound.map(o => {\n          this.ownerIdFromTemplate = o.id;\n          this.owner.firstName = o.firstName;\n        });\n      } else {\n        this.ownerIdFromTemplate = this.notFound;\n      }\n    }\n  }\n  //Sets values upon initilization\n  setCustomerName(customer) {\n    this.customer = customer;\n  }\n  setProductName(product) {\n    this.product = product;\n  }\n  setFaultName(fault) {\n    this.fault = fault;\n  }\n  setOwnerName(owner) {\n    this.owner = owner;\n  }\n  //Get by Id's\n  //private getCustomerIdByName(customerName: string): string {\n  //  let customer = 'Not found'\n  //  this.customerService.findByNameCustomer({ name: customerName }).subscribe(c => customerName = c.customerName!)\n  //  return customer\n  //}\n  update() {\n    //console.log(this.batchDate.value + ' ' + this.docDate.value)\n    if (!this.getCustomer.touched || !this.getCustomer.dirty) {\n      this.form.controls.customer.setValue(this.customer.customerName);\n    }\n    //if ((!this.getDocDate.touched || !this.getDocDate.dirty) && this.getDocDate.value != '') {\n    //  this.form.controls.docDate.setValue(formatDate(this.return.docDate!, 'yyyy-MM-dd', this.locale))\n    //}\n    //if (!this.getDocDate.touched || !this.getDocDate.dirty && this.getDocDate.value == null) {\n    //  this.form.controls.docDate.setValue(this.return.docDate!)\n    //}\n    if (!this.getProduct.touched || !this.getProduct.dirty) {\n      this.form.controls.product.setValue(this.product.productName);\n    }\n    if (!this.getQtyOnDoc.touched || !this.getQtyOnDoc.dirty) {\n      this.form.controls.qtyOnDoc.setValue(this.return.qtyOnDoc);\n    }\n    if ((!this.getBatchDate.touched || !this.getBatchDate.dirty) && this.getBatchDate.value != null) {\n      this.form.controls.batchDate.setValue(formatDate(this.return.batchDate, 'yyyy-MM-dd', this.locale));\n    }\n    if (!this.getBatchDate.touched || !this.getBatchDate.dirty && this.getBatchDate.value == null) {\n      this.form.controls.batchDate.setValue(this.return.batchDate);\n    }\n    if (!this.getOwner.touched || !this.getOwner.dirty) {\n      this.form.controls.owner.setValue(this.owner.firstName);\n    }\n    if (!this.getFault.touched || !this.getFault.dirty) {\n      this.form.controls.fault.setValue(this.fault.name);\n    }\n    if (!this.getDocNo.touched || !this.getDocNo.dirty) {\n      this.form.controls.docNo.setValue(this.return.docNo);\n    }\n    if (!this.getQtyReturned.touched || !this.getQtyReturned.dirty) {\n      this.form.controls.qtyReturned.setValue(this.return.qtyReturned);\n    }\n    if (!this.getResolved.touched || !this.getResolved.dirty) {\n      this.form.controls.resolved.setValue(this.return.resolved);\n    }\n    if (!this.getComment.touched || !this.getComment.dirty) {\n      this.form.controls.comment.setValue(this.return.comment);\n    }\n    console.log(\"Form is valid?: \" + this.form.valid);\n    if (this.form.invalid || this.custIdFromTemplate == this.notFound || this.prodIdFromTemplate == this.notFound || this.faultIdFromTemplate == this.notFound || this.ownerIdFromTemplate == this.notFound) {\n      console.log('The form is invalid');\n      this.formInvalid = 'The values provided is not correct, please try again.';\n      return;\n    }\n    //Convert objects to id's\n    let editedReturn = {\n      id: this.returnId,\n      docDate: this.form.controls.docDate.value.toString(),\n      customerId: this.custIdFromTemplate,\n      productId: this.prodIdFromTemplate,\n      qtyOnDoc: this.form.controls.qtyOnDoc.value,\n      batchDate: this.form.controls.batchDate.value,\n      ownerId: this.ownerIdFromTemplate,\n      faultId: this.faultIdFromTemplate,\n      docNo: this.form.controls.docNo.value,\n      qtyReturned: this.form.controls.qtyReturned.value,\n      resolved: this.form.controls.resolved.value,\n      comment: this.form.controls.comment.value,\n      userId: this.userId\n    };\n    this.showToast = true;\n    if (this.form.valid) {\n      this.message = 'Return updated successfully';\n      console.log('Form Valid: ' + this.form.valid);\n      console.log('Form Touched: ' + this.form.touched);\n      console.log('Form Dirty: ' + this.form.dirty);\n    } else if (this.form.valid && !this.form.touched && !this.form.dirty) {\n      console.log('Form Valid: ' + this.form.valid);\n      console.log('Form Touched: ' + this.form.touched);\n      console.log('Form Dirty: ' + this.form.dirty);\n      this.message = 'Nothing updated';\n    }\n    this.returnService.updateReturnReturn({\n      id: this.returnId,\n      body: editedReturn\n    }).subscribe(_ => {\n      this.appService.setMessage(this.message);\n      this.appService.showToast(this.showToast);\n    }, this.handleError);\n    this.router.navigate(['/']);\n  }\n  //getters\n  get getDocDate() {\n    return this.form.controls.docDate;\n  }\n  get getCustomer() {\n    return this.form.controls.customer;\n  }\n  get getProduct() {\n    return this.form.controls.product;\n  }\n  get getQtyOnDoc() {\n    return this.form.controls.qtyOnDoc;\n  }\n  get getBatchDate() {\n    return this.form.controls.batchDate;\n  }\n  get getOwner() {\n    return this.form.controls.owner;\n  }\n  get getFault() {\n    return this.form.controls.fault;\n  }\n  get getDocNo() {\n    return this.form.controls.docNo;\n  }\n  get getQtyReturned() {\n    return this.form.controls.qtyReturned;\n  }\n  get getResolved() {\n    return this.form.controls.resolved;\n  }\n  get getComment() {\n    return this.form.controls.comment;\n  }\n}\n_class = ReturnDetailComponent;\n_class.ɵfac = function ReturnDetailComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ReturnService), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(LOCALE_ID), i0.ɵɵdirectiveInject(i5.AppService), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i2.CustomerService), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i2.FaultService), i0.ɵɵdirectiveInject(i2.OwnerService));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-return-detail\"]],\n  viewQuery: function ReturnDetailComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.resolvedDropdownRef = _t.first);\n    }\n  },\n  decls: 103,\n  vars: 52,\n  consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"center\", \"shadow-custom\", \"mb-3\"], [1, \"container\"], [1, \"row\"], [1, \"mb-3\", \"col-12\"], [1, \"form-label\"], [\"class\", \"invalid-feedback d-block\", 4, \"ngIf\"], [1, \"input-group\"], [\"type\", \"text\", \"formcontrolName\", \"getCustomer\", 1, \"form-control\", 3, \"ngbTypeahead\", \"inputFormatter\", \"resultFormatter\", \"editable\", \"value\", \"blur\"], [\"customerValue\", \"\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-secondary\", 3, \"routerLink\"], [\"type\", \"text\", \"formcontrolName\", \"product\", 1, \"form-control\", 3, \"ngbTypeahead\", \"inputFormatter\", \"resultFormatter\", \"editable\", \"value\", \"blur\"], [\"prodValue\", \"\"], [1, \"mb-3\", \"col-6\"], [\"formControlName\", \"qtyOnDoc\", \"type\", \"number\", \"min\", \"0\", 1, \"form-control\"], [\"formControlName\", \"qtyReturned\", \"type\", \"number\", \"min\", \"0\", 1, \"form-control\"], [1, \"col-12\"], [1, \"input-group\", \"mb-3\"], [1, \"input-group-text\"], [1, \"me-3\"], [\"type\", \"checkbox\", 1, \"form-check-input\", \"mt-0\", 3, \"checked\", \"change\"], [\"batchChecked\", \"\"], [\"formControlName\", \"batchDate\", \"type\", \"date\", 1, \"form-control\", 3, \"readonly\", \"value\"], [\"batchDateBox\", \"\"], [\"type\", \"text\", \"formcontrolName\", \"owner\", 1, \"form-control\", 3, \"ngbTypeahead\", \"inputFormatter\", \"resultFormatter\", \"editable\", \"value\", \"blur\"], [\"ownerValue\", \"\"], [\"type\", \"text\", \"formcontrolName\", \"fault\", 1, \"form-control\", 3, \"ngbTypeahead\", \"inputFormatter\", \"resultFormatter\", \"editable\", \"value\", \"blur\"], [\"faultValue\", \"\"], [\"formControlName\", \"docNo\", \"type\", \"text\", 1, \"form-control\"], [\"formControlName\", \"docDate\", \"type\", \"date\", 1, \"form-control\"], [\"formControlName\", \"resolved\", 1, \"form-select\"], [\"value\", \"true\", 4, \"ngIf\"], [\"value\", \"false\", 4, \"ngIf\"], [\"formControlName\", \"comment\", \"rows\", \"3\", \"maxlength\", \"255\", 1, \"form-control\"], [\"class\", \"invalid-feedback d-block mb-3\", 4, \"ngIf\"], [1, \"col-md-12\", \"mb-3\"], [\"type\", \"button\", 1, \"btn-outline-danger\", \"btn\", \"col-6\", 3, \"routerLink\"], [1, \"fa\", \"fa-cancel\"], [\"type\", \"submit\", 1, \"btn-outline-success\", \"btn\", \"col-6\"], [1, \"fa\", \"fa-save\"], [1, \"invalid-feedback\", \"d-block\"], [4, \"ngIf\"], [\"value\", \"true\"], [\"value\", \"false\"], [1, \"invalid-feedback\", \"d-block\", \"mb-3\"]],\n  template: function ReturnDetailComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r27 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"h2\");\n      i0.ɵɵtext(1, \"Edit Return\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(2, \"hr\");\n      i0.ɵɵelementStart(3, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function ReturnDetailComponent_Template_form_ngSubmit_3_listener() {\n        return ctx.update();\n      });\n      i0.ɵɵelementStart(4, \"div\", 1)(5, \"div\", 2)(6, \"div\", 3)(7, \"div\", 4)(8, \"label\", 5);\n      i0.ɵɵtext(9, \"Customer\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(10, ReturnDetailComponent_div_10_Template, 2, 1, \"div\", 6);\n      i0.ɵɵtemplate(11, ReturnDetailComponent_div_11_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelementStart(12, \"div\", 7)(13, \"input\", 8, 9);\n      i0.ɵɵlistener(\"blur\", function ReturnDetailComponent_Template_input_blur_13_listener() {\n        i0.ɵɵrestoreView(_r27);\n        const _r2 = i0.ɵɵreference(14);\n        return i0.ɵɵresetView(ctx.getModel(_r2.value, \"customerType\"));\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"button\", 10);\n      i0.ɵɵtext(16, \"+\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 3)(18, \"div\", 4)(19, \"label\", 5);\n      i0.ɵɵtext(20, \"Product\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(21, ReturnDetailComponent_div_21_Template, 2, 1, \"div\", 6);\n      i0.ɵɵtemplate(22, ReturnDetailComponent_div_22_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelementStart(23, \"div\", 7)(24, \"input\", 11, 12);\n      i0.ɵɵlistener(\"blur\", function ReturnDetailComponent_Template_input_blur_24_listener() {\n        i0.ɵɵrestoreView(_r27);\n        const _r5 = i0.ɵɵreference(25);\n        return i0.ɵɵresetView(ctx.getModel(_r5.value, \"productType\"));\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"button\", 10);\n      i0.ɵɵtext(27, \"+\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(28, \"div\", 3)(29, \"div\", 13)(30, \"label\", 5);\n      i0.ɵɵtext(31, \"Qty on Document\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(32, \"input\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"div\", 13)(34, \"label\", 5);\n      i0.ɵɵtext(35, \"Qty Returned\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(36, \"input\", 15);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(37, \"div\", 3)(38, \"div\", 16)(39, \"div\", 17)(40, \"div\", 18)(41, \"span\", 19);\n      i0.ɵɵtext(42, \"No Batch Date\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"input\", 20, 21);\n      i0.ɵɵlistener(\"change\", function ReturnDetailComponent_Template_input_change_43_listener() {\n        return ctx.toggleBatch();\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(45, \"input\", 22, 23);\n      i0.ɵɵpipe(47, \"date\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(48, \"div\", 3)(49, \"div\", 4)(50, \"label\", 5);\n      i0.ɵɵtext(51, \"Owner\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(52, ReturnDetailComponent_div_52_Template, 2, 1, \"div\", 6);\n      i0.ɵɵtemplate(53, ReturnDetailComponent_div_53_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelementStart(54, \"div\", 7)(55, \"input\", 24, 25);\n      i0.ɵɵlistener(\"blur\", function ReturnDetailComponent_Template_input_blur_55_listener() {\n        i0.ɵɵrestoreView(_r27);\n        const _r10 = i0.ɵɵreference(56);\n        return i0.ɵɵresetView(ctx.getModel(_r10.value, \"ownerType\"));\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(57, \"button\", 10);\n      i0.ɵɵtext(58, \"+\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(59, \"div\", 3)(60, \"div\", 4)(61, \"label\", 5);\n      i0.ɵɵtext(62, \"Fault\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(63, ReturnDetailComponent_div_63_Template, 2, 1, \"div\", 6);\n      i0.ɵɵtemplate(64, ReturnDetailComponent_div_64_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelementStart(65, \"div\", 7)(66, \"input\", 26, 27);\n      i0.ɵɵlistener(\"blur\", function ReturnDetailComponent_Template_input_blur_66_listener() {\n        i0.ɵɵrestoreView(_r27);\n        const _r13 = i0.ɵɵreference(67);\n        return i0.ɵɵresetView(ctx.getModel(_r13.value, \"faultType\"));\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(68, \"button\", 10);\n      i0.ɵɵtext(69, \"+\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(70, \"div\", 3)(71, \"div\", 13)(72, \"label\", 5);\n      i0.ɵɵtext(73, \"External Document No.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(74, ReturnDetailComponent_div_74_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelement(75, \"input\", 28);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(76, \"div\", 13)(77, \"label\", 5);\n      i0.ɵɵtext(78, \"Document Date\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(79, ReturnDetailComponent_div_79_Template, 2, 1, \"div\", 6);\n      i0.ɵɵelement(80, \"input\", 29);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(81, \"div\", 3)(82, \"div\", 13)(83, \"label\", 5);\n      i0.ɵɵtext(84, \"Investigate / Resolved\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(85, \"select\", 30);\n      i0.ɵɵtemplate(86, ReturnDetailComponent_option_86_Template, 2, 0, \"option\", 31);\n      i0.ɵɵtemplate(87, ReturnDetailComponent_option_87_Template, 2, 0, \"option\", 32);\n      i0.ɵɵtemplate(88, ReturnDetailComponent_option_88_Template, 2, 0, \"option\", 32);\n      i0.ɵɵtemplate(89, ReturnDetailComponent_option_89_Template, 2, 0, \"option\", 31);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(90, \"div\", 4)(91, \"label\", 5);\n      i0.ɵɵtext(92, \"Comment\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(93, \"textarea\", 33);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(94, ReturnDetailComponent_div_94_Template, 2, 1, \"div\", 34);\n      i0.ɵɵelementStart(95, \"div\", 3)(96, \"div\", 35)(97, \"button\", 36);\n      i0.ɵɵelement(98, \"i\", 37);\n      i0.ɵɵtext(99, \" Cancel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(100, \"button\", 38);\n      i0.ɵɵelement(101, \"i\", 39);\n      i0.ɵɵtext(102, \" Save\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      const _r6 = i0.ɵɵreference(44);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"formGroup\", ctx.form);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.custIdFromTemplate == \"Not Found\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.getCustomer.invalid && (ctx.getCustomer.touched || ctx.getCustomer.dirty));\n      i0.ɵɵadvance(2);\n      i0.ɵɵpropertyInterpolate(\"value\", ctx.customer.customerName);\n      i0.ɵɵproperty(\"ngbTypeahead\", ctx.searchCust)(\"inputFormatter\", ctx.custFormatter)(\"resultFormatter\", ctx.custFormatter)(\"editable\", true);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(47, _c1));\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", ctx.prodIdFromTemplate == \"Not Found\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.getProduct.invalid && (ctx.getProduct.touched || ctx.getProduct.dirty));\n      i0.ɵɵadvance(2);\n      i0.ɵɵpropertyInterpolate(\"value\", ctx.product.productName);\n      i0.ɵɵproperty(\"ngbTypeahead\", ctx.searchProd)(\"inputFormatter\", ctx.prodFormatter)(\"resultFormatter\", ctx.prodFormatter)(\"editable\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(48, _c2));\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"checked\", ctx.return.batchDate == null ? true : false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"readonly\", _r6.checked == true ? true : false)(\"value\", i0.ɵɵpipeBind2(47, 44, ctx.return.batchDate, \"yyyy-MM-dd\"));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.ownerIdFromTemplate == \"Not Found\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.getOwner.invalid && (ctx.getOwner.touched || ctx.getOwner.dirty));\n      i0.ɵɵadvance(2);\n      i0.ɵɵpropertyInterpolate(\"value\", ctx.owner.firstName);\n      i0.ɵɵproperty(\"ngbTypeahead\", ctx.searchOwner)(\"inputFormatter\", ctx.ownerFormatter)(\"resultFormatter\", ctx.ownerFormatter)(\"editable\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(49, _c3));\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", ctx.faultIdFromTemplate == \"Not Found\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.getFault.invalid && (ctx.getFault.touched || ctx.getFault.dirty));\n      i0.ɵɵadvance(2);\n      i0.ɵɵpropertyInterpolate(\"value\", ctx.fault.name);\n      i0.ɵɵproperty(\"ngbTypeahead\", ctx.searchFault)(\"inputFormatter\", ctx.faultFormatter)(\"resultFormatter\", ctx.faultFormatter)(\"editable\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(50, _c4));\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", ctx.getDocNo.invalid && (ctx.getDocNo.touched || ctx.getDocNo.dirty));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.getDocDate.invalid && (ctx.getDocDate.touched || ctx.getDocDate.dirty));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.return.resolved == true);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.return.resolved == false);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.return.resolved == true);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.return.resolved == false);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.formInvalid.length > 0);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(51, _c5));\n    }\n  },\n  dependencies: [i6.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.MaxLengthValidator, i4.MinValidator, i4.FormGroupDirective, i4.FormControlName, i1.RouterLink, i7.NgbTypeahead, i6.DatePipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["formatDate","LOCALE_ID","Validators","debounceTime","distinctUntilChanged","filter","map","i0","ReturnDetailComponent","constructor","route","returnService","router","authService","fb","locale","appService","userService","customerService","productService","faultService","ownerService","notLoaded","group","customer","required","product","qtyOnDoc","qtyReturned","batchDate","owner","fault","docNo","docDate","Date","resolved","comment","customerName","productName","name","firstName","text$","searchCustomer","subscribe","c","customerList","handleError","pipe","term","length","RegExp","test","slice","searchProduct","p","productList","searchFault","f","faultList","searchOwner","o","ownerList","userId","returnId","findReturn","id","r","return","findCustomer","customerId","setCustomerName","custIdFromTemplate","findProduct","productId","setProductName","prodIdFromTemplate","findFault","faultId","setFaultName","faultIdFromTemplate","findOwner","ownerId","setOwnerName","ownerIdFromTemplate","form","controls","setValue","err","status","navigate","console","log","statusText","ngAfterViewInit","ngOnInit","currentUser","findUser","email","u","getUserId","paramMap","get","toggleBatch","batchDateDisable","disable","enable","getModel","modelName","type","modelFound","customerFound","notFound","productFound","faultFound","ownerFound","update","getCustomer","touched","dirty","getProduct","getQtyOnDoc","getBatchDate","value","getOwner","getFault","getDocNo","getQtyReturned","getResolved","getComment","valid","invalid","formInvalid","editedReturn","toString","showToast","message","updateReturnReturn","body","_","setMessage","getDocDate","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\PC\\source\\repos\\Returns-ASP-project\\Returns-ASP-project\\ClientApp\\src\\app\\return-detail\\return-detail.component.ts","C:\\Users\\PC\\source\\repos\\Returns-ASP-project\\Returns-ASP-project\\ClientApp\\src\\app\\return-detail\\return-detail.component.html"],"sourcesContent":["import { formatDate } from '@angular/common';\r\nimport { AfterViewInit, Component, ElementRef, Inject, LOCALE_ID, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { CustomerRm, FaultRm, OwnerRm, ProductRm, ReturnDto } from '../api/models';\r\nimport { ReturnRm } from '../api/models/return-rm';\r\nimport { CustomerService, FaultService, OwnerService, ProductService, ReturnService, UserService } from '../api/services';\r\nimport { AuthService } from '../auth/auth.service';\r\nimport { AppService } from '../app.service';\r\nimport { debounceTime, distinctUntilChanged, filter, map, Observable, OperatorFunction } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-return-detail',\r\n  templateUrl: './return-detail.component.html',\r\n  styleUrls: ['./return-detail.component.css']\r\n})\r\nexport class ReturnDetailComponent implements OnInit, AfterViewInit {\r\n  @ViewChild('resolvedDropdown', { static: true }) resolvedDropdownRef?: ElementRef<HTMLElement>;\r\n  //form: FormGroup;\r\n\r\n  constructor(private route: ActivatedRoute, private returnService: ReturnService, private router: Router, private authService: AuthService,\r\n    private fb: FormBuilder, @Inject(LOCALE_ID) private locale: string, private appService: AppService, private userService: UserService, private customerService: CustomerService,\r\n    private productService: ProductService, private faultService: FaultService, private ownerService: OwnerService) {\r\n\r\n}\r\n\r\n  ngAfterViewInit() {\r\n\r\n  }\r\n\r\n  notFound = 'Not Found'\r\n  notLoaded = 'Not Loaded'\r\n  formInvalid = ''\r\n\r\n  returnId: string = this.notLoaded\r\n  batchDateDisable = false\r\n  modelInUse = 'none'\r\n  return: ReturnRm = {}\r\n  customer: CustomerRm = {}\r\n  product: ProductRm = {}\r\n  fault: FaultRm = {}\r\n  owner: OwnerRm = {}\r\n  custIdFromTemplate = ''\r\n  prodIdFromTemplate = ''\r\n  faultIdFromTemplate = ''\r\n  ownerIdFromTemplate = ''\r\n\r\n  customerList: CustomerRm[] = []\r\n  productList: ProductRm[] = []\r\n  faultList: FaultRm[] = []\r\n  ownerList: OwnerRm[] = []\r\n\r\n  message = 'Something went wrong...'\r\n  showToast = false;\r\n  userId = this.notLoaded\r\n\r\n\r\n  form = this.fb.group({\r\n    customer: ['', Validators.required],\r\n    product: ['', Validators.required],\r\n    qtyOnDoc: [0],\r\n    qtyReturned: [0],\r\n    batchDate: [''],\r\n    owner: [''],\r\n    fault: [''],\r\n    docNo: ['', Validators.required],\r\n    docDate: [new Date, Validators.required],\r\n    resolved: [true],\r\n    comment: ['']\r\n  })\r\n\r\n  custFormatter = (customer: CustomerRm) => customer.customerName!\r\n  prodFormatter = (product: ProductRm) => product.productName!\r\n  faultFormatter = (fault: FaultRm) => fault.name!\r\n  ownerFormatter = (owner: OwnerRm) => owner.firstName!\r\n\r\n  //Gets all customers for searchbox\r\n  searchCust: OperatorFunction<string, readonly { id?: string | undefined | null; name?: string | undefined | null }[]> = (text$: Observable<string>) => {\r\n    this.customerService.searchCustomer().subscribe(c => this.customerList = c, this.handleError)\r\n\r\n    return text$.pipe(\r\n          debounceTime(200),\r\n          distinctUntilChanged(),\r\n          filter((term) => term.length >= 2),\r\n          map((term) => this.customerList.filter((customer) => new RegExp(term, 'mi').test(customer.customerName!)).slice(0, 10))\r\n      );\r\n  }\r\n\r\n  //Gets all products for searchbox\r\n  searchProd: OperatorFunction<string, readonly { id?: string | undefined | null; name?: string | undefined | null }[]> = (text$: Observable<string>) => {\r\n    this.productService.searchProduct().subscribe(p => this.productList = p, this.handleError)\r\n\r\n    return text$.pipe(\r\n      debounceTime(200),\r\n      distinctUntilChanged(),\r\n      filter((term) => term.length >= 2),\r\n      map((term) => this.productList.filter((product) => new RegExp(term, 'mi').test(product.productName!)).slice(0, 10))\r\n    );\r\n  }\r\n\r\n  //Gets all faults for searchbox\r\n  searchFault: OperatorFunction<string, readonly { id?: string | undefined | null; name?: string | undefined | null }[]> = (text$: Observable<string>) => {\r\n    this.faultService.searchFault().subscribe(f => this.faultList = f, this.handleError)\r\n\r\n    return text$.pipe(\r\n      debounceTime(200),\r\n      distinctUntilChanged(),\r\n      filter((term) => term.length >= 2),\r\n      map((term) => this.faultList.filter((fault) => new RegExp(term, 'mi').test(fault.name!)).slice(0, 10))\r\n    );\r\n  }\r\n\r\n  //Gets all owners for searchbox\r\n  searchOwner: OperatorFunction<string, readonly { id?: string | undefined | null; name?: string | undefined | null }[]> = (text$: Observable<string>) => {\r\n    this.ownerService.searchOwner().subscribe(o => this.ownerList = o, this.handleError)\r\n\r\n    return text$.pipe(\r\n      debounceTime(200),\r\n      distinctUntilChanged(),\r\n      filter((term) => term.length >= 2),\r\n      map((term) => this.ownerList.filter((owner) => new RegExp(term, 'mi').test(owner.firstName!)).slice(0, 10))\r\n    );\r\n  }\r\n\r\n\r\n  ngOnInit(): void {\r\n\r\n    if (!this.authService.currentUser) {\r\n      this.router.navigate(['/register-user'])\r\n    }\r\n\r\n    this.userService.findUser({ email: this.authService.currentUser?.email! }).subscribe(u => {\r\n      this.getUserId(u.id!); console.log('The user id in the oninit subscribe call is: ' + this.userId)\r\n    })\r\n\r\n    this.route.paramMap.subscribe(p => this.findReturn(p.get(\"returnId\")));\r\n\r\n    console.log('OnInit userEmail = ' + this.authService.currentUser?.email!)\r\n\r\n    \r\n  }\r\n\r\n  private getUserId = (userId : string)=> {\r\n    this.userId = userId\r\n  }\r\n  \r\n  private findReturn = (returnId: string | null) => {\r\n    this.returnId = returnId ?? 'not passed';\r\n\r\n    this.returnService.findReturn({ id: this.returnId }).subscribe(r =>\r\n    {\r\n      this.return = r\r\n      this.customerService.findCustomer({ id: r.customerId! }).subscribe(c => { this.setCustomerName(c); this.custIdFromTemplate = c.id! }, this.handleError)\r\n      this.productService.findProduct({ id: r.productId! }).subscribe(p => { this.setProductName(p); this.prodIdFromTemplate = p.id! }, this.handleError)\r\n      this.faultService.findFault({ id: r.faultId! }).subscribe(f => { this.setFaultName(f); this.faultIdFromTemplate = f.id! }, this.handleError)\r\n      this.ownerService.findOwner({ id: r.ownerId! }).subscribe(o => { this.setOwnerName(o); this.ownerIdFromTemplate = o.id! }, this.handleError)\r\n      //this.userService.findUser({ }) set up endpoint to find user by Id as well\r\n      this.form.controls.qtyOnDoc.setValue(r.qtyOnDoc!)\r\n      this.form.controls.qtyReturned.setValue(r.qtyReturned!)\r\n      this.form.controls.batchDate.setValue(r.batchDate!)\r\n      this.form.controls.docNo.setValue(r.docNo!)\r\n      this.form.controls.docDate.setValue(new Date(r.docDate!))\r\n      this.form.controls.resolved.setValue(r.resolved!)\r\n      this.form.controls.comment.setValue(r.comment!)\r\n    }\r\n      , this.handleError);\r\n  }\r\n\r\n  toggleBatch() {\r\n    this.batchDateDisable = !this.batchDateDisable;\r\n\r\n    if (this.batchDateDisable == true && this.return.batchDate?.length! > 1) {\r\n      this.form.controls['batchDate'].disable()\r\n      this.form.controls.batchDate.setValue(null)\r\n    }\r\n    else if (this.batchDateDisable == false && this.return.batchDate?.length! > 1) {\r\n      this.form.controls['batchDate'].enable()\r\n    }\r\n    else if (this.batchDateDisable == true ) {\r\n      this.form.controls['batchDate'].enable()\r\n      this.form.controls.batchDate.setValue(null)\r\n    }\r\n    else if (this.batchDateDisable == false) {\r\n      this.form.controls['batchDate'].disable()\r\n    }\r\n  }\r\n\r\n  //Gets the id and name of the model in the search criteria\r\n  getModel(modelName: string, type: string) {\r\n    let modelFound: any[] = []\r\n\r\n    //Get the type of model\r\n    if (type == 'customerType') {\r\n      let customerFound = this.customerList.filter(c => c.customerName == modelName)\r\n      console.log(customerFound.length)\r\n      if (customerFound.length > 0) {\r\n        customerFound.map(c => { this.custIdFromTemplate = c.id!; this.customer.customerName = c.customerName! })\r\n      }\r\n      else {\r\n        this.custIdFromTemplate = this.notFound\r\n      }\r\n    }\r\n\r\n    if (type == 'productType') {\r\n      let productFound = this.productList.filter(p => p.productName == modelName)\r\n      if (productFound.length > 0) {\r\n        productFound.map(p => { this.prodIdFromTemplate = p.id!; this.product.productName = p.productName! })\r\n      }\r\n      else {\r\n        this.prodIdFromTemplate = this.notFound\r\n      }\r\n    }\r\n    if (type == 'faultType') {\r\n      let faultFound = this.faultList.filter(f => f.name == modelName)\r\n      if (faultFound.length > 0) {\r\n        faultFound.map(f => { this.faultIdFromTemplate = f.id!; this.fault.name = f.name! })\r\n      }\r\n      else {\r\n        this.faultIdFromTemplate = this.notFound\r\n      }\r\n    }\r\n    if (type == 'ownerType') {\r\n      let ownerFound = this.ownerList.filter(o => o.firstName == modelName)\r\n      if (ownerFound.length > 0) {\r\n        ownerFound.map(o => { this.ownerIdFromTemplate = o.id!; this.owner.firstName = o.firstName! })\r\n      }\r\n      else {\r\n        this.ownerIdFromTemplate = this.notFound\r\n      }\r\n    }\r\n    \r\n\r\n  }\r\n\r\n  private handleError = (err: any) => {\r\n\r\n    if (err.status == 404) {\r\n      this.router.navigate(['/search-returns'])\r\n    }\r\n      \r\n    console.log(\"Response Error. Status: \", err.status)\r\n    console.log(\"Response Error. Status: \", err.statusText)\r\n    console.log(err);\r\n  }\r\n\r\n  //Sets values upon initilization\r\n\r\n  private setCustomerName(customer: CustomerRm) {\r\n    this.customer = customer\r\n  }\r\n\r\n  private setProductName(product: ProductRm) {\r\n    this.product = product\r\n  }\r\n\r\n  private setFaultName(fault: FaultRm) {\r\n   this.fault = fault\r\n  }\r\n\r\n  private setOwnerName(owner: OwnerRm) {\r\n    this.owner = owner\r\n  }\r\n\r\n  //Get by Id's\r\n  //private getCustomerIdByName(customerName: string): string {\r\n  //  let customer = 'Not found'\r\n  //  this.customerService.findByNameCustomer({ name: customerName }).subscribe(c => customerName = c.customerName!)\r\n  //  return customer\r\n  //}\r\n\r\n  update() {\r\n\r\n\r\n\r\n    //console.log(this.batchDate.value + ' ' + this.docDate.value)\r\n\r\n    if (!this.getCustomer.touched || !this.getCustomer.dirty) {\r\n      this.form.controls.customer.setValue(this.customer.customerName!)\r\n    }\r\n    //if ((!this.getDocDate.touched || !this.getDocDate.dirty) && this.getDocDate.value != '') {\r\n    //  this.form.controls.docDate.setValue(formatDate(this.return.docDate!, 'yyyy-MM-dd', this.locale))\r\n    //}\r\n    //if (!this.getDocDate.touched || !this.getDocDate.dirty && this.getDocDate.value == null) {\r\n    //  this.form.controls.docDate.setValue(this.return.docDate!)\r\n    //}\r\n    if (!this.getProduct.touched || !this.getProduct.dirty) {\r\n      this.form.controls.product.setValue(this.product.productName!)\r\n    }\r\n    if (!this.getQtyOnDoc.touched || !this.getQtyOnDoc.dirty) {\r\n      this.form.controls.qtyOnDoc.setValue(this.return.qtyOnDoc!)\r\n    }\r\n    if ((!this.getBatchDate.touched || !this.getBatchDate.dirty) && this.getBatchDate.value != null) {\r\n      this.form.controls.batchDate.setValue(formatDate(this.return.batchDate!, 'yyyy-MM-dd', this.locale))\r\n    }\r\n    if (!this.getBatchDate.touched || !this.getBatchDate.dirty && this.getBatchDate.value == null) {\r\n      this.form.controls.batchDate.setValue(this.return.batchDate!)\r\n    }\r\n    if (!this.getOwner.touched || !this.getOwner.dirty) {\r\n      this.form.controls.owner.setValue(this.owner.firstName!)\r\n    }\r\n    if (!this.getFault.touched || !this.getFault.dirty) {\r\n      this.form.controls.fault.setValue(this.fault.name!)\r\n    }\r\n    if (!this.getDocNo.touched || !this.getDocNo.dirty) {\r\n      this.form.controls.docNo.setValue(this.return.docNo!)\r\n    }\r\n    if (!this.getQtyReturned.touched || !this.getQtyReturned.dirty) {\r\n      this.form.controls.qtyReturned.setValue(this.return.qtyReturned!)\r\n    }\r\n    if (!this.getResolved.touched || !this.getResolved.dirty) {\r\n      this.form.controls.resolved.setValue(this.return.resolved!)\r\n    }\r\n    if (!this.getComment.touched || !this.getComment.dirty) {\r\n      this.form.controls.comment.setValue(this.return.comment!)\r\n    }\r\n\r\n    console.log(\"Form is valid?: \" + this.form.valid)\r\n\r\n    if (this.form.invalid || this.custIdFromTemplate == this.notFound || this.prodIdFromTemplate == this.notFound || this.faultIdFromTemplate == this.notFound || this.ownerIdFromTemplate == this.notFound) {\r\n      console.log('The form is invalid')\r\n      this.formInvalid = 'The values provided is not correct, please try again.'\r\n      return\r\n    }\r\n\r\n\r\n    //Convert objects to id's\r\n    let editedReturn: ReturnRm = {\r\n      id: this.returnId,\r\n      docDate: this.form.controls.docDate.value!.toString(),\r\n      customerId: this.custIdFromTemplate!,\r\n      productId: this.prodIdFromTemplate!,\r\n      qtyOnDoc: this.form.controls.qtyOnDoc.value!,\r\n      batchDate: this.form.controls.batchDate.value!,\r\n      ownerId: this.ownerIdFromTemplate!,\r\n      faultId: this.faultIdFromTemplate!,\r\n      docNo: this.form.controls.docNo.value!,\r\n      qtyReturned: this.form.controls.qtyReturned.value!,\r\n      resolved: this.form.controls.resolved.value!,\r\n      comment: this.form.controls.comment.value!,\r\n      userId: this.userId!\r\n\r\n    }\r\n\r\n    \r\n    this.showToast = true\r\n    if (this.form.valid) {\r\n      this.message = 'Return updated successfully'\r\n      console.log('Form Valid: ' + this.form.valid)\r\n      console.log('Form Touched: ' + this.form.touched)\r\n      console.log('Form Dirty: ' + this.form.dirty)\r\n    }\r\n    else if (this.form.valid && !this.form.touched && !this.form.dirty) {\r\n      console.log('Form Valid: ' + this.form.valid)\r\n      console.log('Form Touched: ' + this.form.touched)\r\n      console.log('Form Dirty: ' + this.form.dirty)\r\n      this.message = 'Nothing updated'\r\n    }\r\n  \r\n    this.returnService.updateReturnReturn({ id: this.returnId, body: editedReturn }).subscribe(_ => { this.appService.setMessage(this.message); this.appService.showToast(this.showToast)},this.handleError)\r\n    this.router.navigate(['/']);\r\n  }\r\n\r\n  //getters\r\n  get getDocDate() {\r\n    return this.form.controls.docDate\r\n  }\r\n\r\n  get getCustomer() {\r\n    return this.form.controls.customer\r\n  }\r\n\r\n  get getProduct() {\r\n    return this.form.controls.product\r\n  }\r\n\r\n  get getQtyOnDoc() {\r\n    return this.form.controls.qtyOnDoc\r\n  }\r\n\r\n  get getBatchDate() {\r\n    return this.form.controls.batchDate\r\n  }\r\n\r\n  get getOwner() {\r\n    return this.form.controls.owner\r\n  }\r\n\r\n  get getFault() {\r\n    return this.form.controls.fault\r\n  }\r\n\r\n  get getDocNo() {\r\n    return this.form.controls.docNo\r\n  }\r\n\r\n  get getQtyReturned() {\r\n    return this.form.controls.qtyReturned\r\n  }\r\n\r\n  get getResolved() {\r\n    return this.form.controls.resolved\r\n  }\r\n\r\n  get getComment() {\r\n    return this.form.controls.comment\r\n  }\r\n\r\n}\r\n","<h2>Edit Return</h2>\r\n<hr />\r\n\r\n<form [formGroup]=\"form\" (ngSubmit)=\"update()\">\r\n  <div class=\"center shadow-custom mb-3\">\r\n    <div class=\"container\">\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-12\">\r\n          <label class=\"form-label\">Customer</label>\r\n          <div *ngIf=\"custIdFromTemplate == 'Not Found'\" class=\"invalid-feedback d-block\">{{custIdFromTemplate}}</div>\r\n          <div *ngIf=\"getCustomer.invalid && (getCustomer.touched || getCustomer.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getCustomer.errors?.['required']\">Customer is required</div>\r\n          </div>\r\n          <div class=\"input-group\">\r\n            <input #customerValue\r\n                   type=\"text\"\r\n                   class=\"form-control\"\r\n                   [ngbTypeahead]=\"searchCust\"\r\n                   [inputFormatter]=\"custFormatter\"\r\n                   [resultFormatter]=\"custFormatter\"\r\n                   [editable]=\"true\"\r\n                   formcontrolName=\"getCustomer\"\r\n                   value=\"{{customer.customerName}}\"\r\n                   (blur)=\"getModel(customerValue.value, 'customerType')\"\r\n                   />\r\n            <button class=\"btn btn-outline-secondary\" [routerLink]=\"['/customer-detail']\" type=\"button\">+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-12\">\r\n          <label class=\"form-label\">Product</label>\r\n          <div *ngIf=\"prodIdFromTemplate == 'Not Found'\" class=\"invalid-feedback d-block\">{{prodIdFromTemplate}}</div>\r\n          <div *ngIf=\"getProduct.invalid && (getProduct.touched || getProduct.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getProduct.errors?.['required']\">Product is required</div>\r\n          </div>\r\n          <div class=\"input-group\">\r\n            <input #prodValue\r\n                   type=\"text\"\r\n                   class=\"form-control\"\r\n                   [ngbTypeahead]=\"searchProd\"\r\n                   [inputFormatter]=\"prodFormatter\"\r\n                   [resultFormatter]=\"prodFormatter\"\r\n                   [editable]=\"false\"\r\n                   formcontrolName=\"product\"\r\n                   value=\"{{product.productName}}\"\r\n                   (blur)=\"getModel(prodValue.value, 'productType')\" />\r\n            <button class=\"btn btn-outline-secondary\" [routerLink]=\"['/product-detail']\" type=\"button\">+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-6\">\r\n          <label class=\"form-label\">Qty on Document</label>\r\n          <input formControlName=\"qtyOnDoc\" type=\"number\" min=\"0\" class=\"form-control\">\r\n        </div>\r\n\r\n        <div class=\"mb-3 col-6\">\r\n          <label class=\"form-label\">Qty Returned</label>\r\n          <input formControlName=\"qtyReturned\" type=\"number\" min=\"0\" class=\"form-control\">\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"col-12\">\r\n          <div class=\"input-group mb-3\">\r\n            <div class=\"input-group-text\">\r\n              <span class=\"me-3\">No Batch Date</span>\r\n              <input class=\"form-check-input mt-0\" type=\"checkbox\" #batchChecked (change)=\"toggleBatch()\" [checked]=\"return.batchDate == null ? true : false\">\r\n            </div>\r\n            <input formControlName=\"batchDate\" type=\"date\" #batchDateBox [readonly]=\"batchChecked.checked == true ? true : false\" class=\"form-control\" [value]=\"return.batchDate | date:'yyyy-MM-dd'\">\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-12\">\r\n          <label class=\"form-label\">Owner</label>\r\n          <div *ngIf=\"ownerIdFromTemplate == 'Not Found'\" class=\"invalid-feedback d-block\">{{ownerIdFromTemplate}}</div>\r\n          <div *ngIf=\"getOwner.invalid && (getOwner.touched || getOwner.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getOwner.errors?.['required']\">Owner is required</div>\r\n          </div>\r\n          <div class=\"input-group\">\r\n            <input #ownerValue\r\n                   type=\"text\"\r\n                   class=\"form-control\"\r\n                   [ngbTypeahead]=\"searchOwner\"\r\n                   [inputFormatter]=\"ownerFormatter\"\r\n                   [resultFormatter]=\"ownerFormatter\"\r\n                   [editable]=\"false\"\r\n                   formcontrolName=\"owner\"\r\n                   value=\"{{owner.firstName}}\"\r\n                   (blur)=\"getModel(ownerValue.value, 'ownerType')\" />\r\n            <button class=\"btn btn-outline-secondary\" [routerLink]=\"['/owner-detail']\" type=\"button\">+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-12\">\r\n          <label class=\"form-label\">Fault</label>\r\n          <div *ngIf=\"faultIdFromTemplate == 'Not Found'\" class=\"invalid-feedback d-block\">{{faultIdFromTemplate}}</div>\r\n          <div *ngIf=\"getFault.invalid && (getFault.touched || getFault.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getFault.errors?.['required']\">Fault is required</div>\r\n          </div>\r\n          <div class=\"input-group\">\r\n            <input #faultValue\r\n                   type=\"text\"\r\n                   class=\"form-control\"\r\n                   [ngbTypeahead]=\"searchFault\"\r\n                   [inputFormatter]=\"faultFormatter\"\r\n                   [resultFormatter]=\"faultFormatter\"\r\n                   [editable]=\"false\"\r\n                   formcontrolName=\"fault\"\r\n                   value=\"{{fault.name}}\"\r\n                   (blur)=\"getModel(faultValue.value, 'faultType')\" />\r\n            <button class=\"btn btn-outline-secondary\" [routerLink]=\"['/fault-detail']\" type=\"button\">+</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-6\">\r\n          <label class=\"form-label\">External Document No.</label>\r\n          <div *ngIf=\"getDocNo.invalid && (getDocNo.touched || getDocNo.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getDocNo.errors?.['required']\">Document Number is required</div>\r\n          </div>\r\n          <input formControlName=\"docNo\" type=\"text\" class=\"form-control\">\r\n        </div>\r\n\r\n        <div class=\"mb-3 col-6\">\r\n          <label class=\"form-label\">Document Date</label>\r\n          <div *ngIf=\"getDocDate.invalid && (getDocDate.touched || getDocDate.dirty)\" class=\"invalid-feedback d-block\">\r\n            <div *ngIf=\"getDocDate.errors?.['required']\">Document Date is required</div>\r\n          </div>\r\n          <input formControlName=\"docDate\" type=\"date\" class=\"form-control\">\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"mb-3 col-6\">\r\n          <label class=\"form-label\">Investigate / Resolved</label>\r\n          <select formControlName=\"resolved\" class=\"form-select\">\r\n            <option *ngIf=\"return.resolved == true\" value=true>Resolved</option>\r\n            <option *ngIf=\"return.resolved == false\" value=false>Investigate</option>\r\n            <option *ngIf=\"return.resolved == true\" value=false>Investigate</option>\r\n            <option *ngIf=\"return.resolved == false\" value=true>Resolved</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"mb-3 col-12\">\r\n        <label class=\"form-label\">Comment</label>\r\n        <textarea formControlName=\"comment\" class=\"form-control\" rows=\"3\" maxlength=\"255\"></textarea>\r\n      </div>\r\n\r\n      <div class=\"invalid-feedback d-block mb-3\" *ngIf=\"formInvalid.length > 0\">\r\n        {{formInvalid}}\r\n      </div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"col-md-12 mb-3\">\r\n          <button type=\"button\" [routerLink]=\"['/']\" class=\"btn-outline-danger btn col-6\"><i class=\"fa fa-cancel\"></i> Cancel</button>\r\n          <button type=\"submit\" class=\"btn-outline-success btn col-6\"><i class=\"fa fa-save\"></i> Save</button>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}